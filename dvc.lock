schema: '2.0'
stages:
  createtiles@2019:
    cmd: mkdir data/processed; gdal_retile.py  -csv locations.csv  -v -ps 8192 8192
      -co "TILED=YES" -co "COMPRESS=LZW"  -targetDir data/processed.images.2019  data/raw/ortho_2019_ESPG3044.tif
    deps:
    - path: data/raw/ortho_2019_ESPG3044.tif
      md5: 746e66cb751ca75c9497920f53cdc0b8
      size: 381359748231
    params:
      params.yaml:
        source_dim: 8192
    outs:
    - path: data/processed.images.2019
      md5: a3c48148cd75adc9b069207edf27b637.dir
      size: 169321666330
      nfiles: 1925
  createmasks:
    cmd: python createmasks.py  --bbox data/raw/shapefiles/deadtrees_area/deadtrees_area.shp
      data/processed.images.2019  data/processed.masks.2019  data/raw/shapefiles/deadtrees/deadtrees.shp
    deps:
    - path: data/processed.images.2019
      md5: a3c48148cd75adc9b069207edf27b637.dir
      size: 169321666330
      nfiles: 1925
    - path: data/raw/shapefiles/deadtrees
      md5: fdc094c879c6588fe71d19a7177eda48.dir
      size: 1665350
      nfiles: 5
    - path: data/raw/shapefiles/deadtrees_area
      md5: f098a36246abde3d3e0c0efa6183093a.dir
      size: 1756
      nfiles: 5
    outs:
    - path: data/processed.masks.2019
      md5: bcdadbbf7cb31f3a2a4f437290dcbd28.dir
      size: 3288758774
      nfiles: 49
  createdataset:
    cmd: python createdataset.py data/processed.images.2019 data/processed.masks.2019
      data/dataset  --source_dim 8192 --tile_size 512 --format PNG
    deps:
    - path: data/processed.images.2019
      md5: a3c48148cd75adc9b069207edf27b637.dir
      size: 169321666330
      nfiles: 1925
    - path: data/processed.masks.2019
      md5: bcdadbbf7cb31f3a2a4f437290dcbd28.dir
      size: 3288758774
      nfiles: 49
    params:
      params.yaml:
        createdataset.tile_size: 512
        file_type: PNG
        source_dim: 8192
    outs:
    - path: data/dataset/stats.csv
      md5: 06da46443d403f1fd39a2c75131ec3b4
      size: 387162
    - path: data/dataset/train
      md5: feea90303b5e61da575c3cc91b6dbe81.dir
      size: 4677847040
      nfiles: 23
  createbalanced:
    cmd: python createbalanced.py  data/dataset/stats.csv data/dataset/train  data/dataset/train_balanced  data/dataset/train_balanced_short
      --format PNG --tmp-dir ./tmp
    deps:
    - path: data/dataset/stats.csv
      md5: 06da46443d403f1fd39a2c75131ec3b4
      size: 387162
    - path: data/dataset/train
      md5: feea90303b5e61da575c3cc91b6dbe81.dir
      size: 4677847040
      nfiles: 23
    params:
      params.yaml:
        file_type: PNG
    outs:
    - path: data/dataset/train_balanced
      md5: f4c61bf5f8202e596872264b2fbc39e3.dir
      size: 4644454400
      nfiles: 11
    - path: data/dataset/train_balanced_short
      md5: 31793179278cb8e6852203ff56903936.dir
      size: 223795200
      nfiles: 2

